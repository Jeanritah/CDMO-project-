services:
  cdmo:
    build:
      context: .                    # Build only if Dockerfile or context changes
      dockerfile: Dockerfile
      args:
        AMPL_LICENSE_UUID: ${AMPL_LICENSE_UUID}  # Pass license key as build arg
    image: cdmo-env:latest          # Keeps the built image cached

    container_name: cdmo_dev

    # Mount your working directory so edits on host show inside the container
    volumes:
      - ./:/CDMO                     # Sync project folder
      - ./res:/CDMO/res              # Persist results
      - ./source:/CDMO/source        # Persist model/code

    env_file:
      - .env                         # Environment variables at runtime

    # Enable interactive bash by default
    tty: true
    stdin_open: true
